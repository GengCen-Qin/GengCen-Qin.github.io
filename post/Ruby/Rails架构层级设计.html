<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Railså±‚çº§è®¾è®¡æ¼”åŒ– | ç²è¾°ä¹¦æ–‹</title><meta name="author" content="åºšè¾°"><meta name="copyright" content="åºšè¾°"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Railså±‚çº§è®¾è®¡æ¼”åŒ– ç›¸å…³èµ„æ–™   37signal - å±‚çº§è®¾è®¡ 37signal - concernè®¾è®¡ å±‚çº§è®¾è®¡ç¿»è¯‘ concernè®¾è®¡ç¿»è¯‘ gitlab-dddåº”ç”¨  ç‰ˆæœ¬1æˆ‘ä»¬éƒ½çŸ¥é“railsåˆå§‹åŒ–é¡¹ç›®ï¼Œåœ¨å±‚çº§æ‹†åˆ†ä¸Šåªæœ‰ä¸¤å±‚  controller model  graph TD     A[Controller] --&gt;|è°ƒç”¨| B[Model]  controllerè´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œ">
<meta property="og:type" content="article">
<meta property="og:title" content="Railså±‚çº§è®¾è®¡æ¼”åŒ–">
<meta property="og:url" content="http://www.chengling.cloud/post/Ruby/Rails%E6%9E%B6%E6%9E%84%E5%B1%82%E7%BA%A7%E8%AE%BE%E8%AE%A1.html">
<meta property="og:site_name" content="ç²è¾°ä¹¦æ–‹">
<meta property="og:description" content="Railså±‚çº§è®¾è®¡æ¼”åŒ– ç›¸å…³èµ„æ–™   37signal - å±‚çº§è®¾è®¡ 37signal - concernè®¾è®¡ å±‚çº§è®¾è®¡ç¿»è¯‘ concernè®¾è®¡ç¿»è¯‘ gitlab-dddåº”ç”¨  ç‰ˆæœ¬1æˆ‘ä»¬éƒ½çŸ¥é“railsåˆå§‹åŒ–é¡¹ç›®ï¼Œåœ¨å±‚çº§æ‹†åˆ†ä¸Šåªæœ‰ä¸¤å±‚  controller model  graph TD     A[Controller] --&gt;|è°ƒç”¨| B[Model]  controllerè´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.chengling.cloud/img/default_top_img.jpg">
<meta property="article:published_time" content="2025-07-09T02:30:12.000Z">
<meta property="article:modified_time" content="2025-07-09T14:24:27.338Z">
<meta property="article:author" content="åºšè¾°">
<meta property="article:tag" content="rails">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.chengling.cloud/img/default_top_img.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.chengling.cloud/post/Ruby/Rails%E6%9E%B6%E6%9E%84%E5%B1%82%E7%BA%A7%E8%AE%BE%E8%AE%A1"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Railså±‚çº§è®¾è®¡æ¼”åŒ–',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-07-09 22:24:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/myHead.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">21</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/default_top_img.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ç²è¾°ä¹¦æ–‹</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºç¬”è€…</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Railså±‚çº§è®¾è®¡æ¼”åŒ–</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-07-09T02:30:12.000Z" title="å‘è¡¨äº 2025-07-09 10:30:12">2025-07-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-07-09T14:24:27.338Z" title="æ›´æ–°äº 2025-07-09 22:24:27">2025-07-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Ruby/">Ruby</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Railså±‚çº§è®¾è®¡æ¼”åŒ–"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Railså±‚çº§è®¾è®¡æ¼”åŒ–"><a href="#Railså±‚çº§è®¾è®¡æ¼”åŒ–" class="headerlink" title="Railså±‚çº§è®¾è®¡æ¼”åŒ–"></a>Railså±‚çº§è®¾è®¡æ¼”åŒ–</h1><blockquote>
<p>ç›¸å…³èµ„æ–™</p>
</blockquote>
<ol>
<li><a target="_blank" rel="noopener" href="https://dev.37signals.com/vanilla-rails-is-plenty/">37signal - å±‚çº§è®¾è®¡</a></li>
<li><a target="_blank" rel="noopener" href="https://dev.37signals.com/good-concerns/">37signal - concernè®¾è®¡</a></li>
<li><a target="_blank" rel="noopener" href="https://xfyuan.github.io/2022/11/vanilla-rails-is-plenty">å±‚çº§è®¾è®¡ç¿»è¯‘</a></li>
<li><a target="_blank" rel="noopener" href="https://dev.37signals.com/good-concerns/">concernè®¾è®¡ç¿»è¯‘</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1F94y1s7kx/?spm_id_from=333.337.search-card.all.click">gitlab-dddåº”ç”¨</a></li>
</ol>
<h2 id="ç‰ˆæœ¬1"><a href="#ç‰ˆæœ¬1" class="headerlink" title="ç‰ˆæœ¬1"></a>ç‰ˆæœ¬1</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“railsåˆå§‹åŒ–é¡¹ç›®ï¼Œåœ¨å±‚çº§æ‹†åˆ†ä¸Šåªæœ‰ä¸¤å±‚</p>
<ol>
<li>controller</li>
<li>model</li>
</ol>
<pre class="line-numbers language-mermaid" data-language="mermaid"><code class="language-mermaid"><span class="token keyword">graph</span> TD
    A<span class="token text string">[Controller]</span> <span class="token arrow operator">--></span><span class="token label property">|è°ƒç”¨|</span> B<span class="token text string">[Model]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>controllerè´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œmodelè´Ÿè´£å®ç°å­˜å‚¨ï¼Œé‚£ä¸šåŠ¡é€»è¾‘åœ¨å“ªé‡Œå®ç°ï¼Ÿ</p>
<p>å¯èƒ½ä¸ºäº†modelçš„å¹²å‡€ï¼Œä½ å¯èƒ½å°†ä¸šåŠ¡é€»è¾‘å†™åˆ°controllerä¸­ã€‚ä¹Ÿæœ‰å¯èƒ½ä¸ºäº†å¤ç”¨ï¼Œå°†ä¸šåŠ¡é€»è¾‘å†™åœ¨modelä¸­ã€‚ä½†ä¸ç®¡é€‰æ‹©å“ªç§æ–¹å¼ï¼Œéšç€ä¸šåŠ¡é€»è¾‘çš„ä¸æ–­è¿­ä»£ï¼Œä½ çš„controlleræˆ–è€…modelä¹Ÿé€æ¸çš„è‡ƒè‚¿ã€‚å˜å¾—éš¾ä»¥ç»´æŠ¤ï¼Œä¹Ÿæœ‰å¾ˆå¤šäººæ‰¹è¯„è¯´ä¸åº”è¯¥controllerç›´æ¥è®¿é—®modelå±‚ï¼Œè‡ªç„¶è€Œç„¶çš„å¤§å®¶å†³å®šæŠ½ç¦»å‡ºä¸šåŠ¡å±‚ï¼Œæ¯”å¦‚ï¼šServiceï¼ŒCommandç­‰ç­‰</p>
<h2 id="ç‰ˆæœ¬2"><a href="#ç‰ˆæœ¬2" class="headerlink" title="ç‰ˆæœ¬2"></a>ç‰ˆæœ¬2</h2><p>æ¯”å¦‚æˆ‘æœ‰ä¸€ä¸ªæŠ¥ä»·å•æ¨¡å‹ï¼Œæˆ‘å¯èƒ½æœ‰ç±»ä¼¼çš„ç»“æ„</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># controller</span>
<span class="token keyword">class</span> <span class="token class-name">QuotationController</span> <span class="token operator">&lt;</span> ApplicationController
<span class="token keyword">end</span>

<span class="token comment"># Command</span>
<span class="token keyword">class</span> <span class="token class-name">QuotationCommand</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create</span></span>
  <span class="token keyword">end</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">list</span></span>
  <span class="token keyword">end</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">modify</span></span>
  <span class="token keyword">end</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">delete</span></span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token comment"># model</span>
<span class="token keyword">class</span> <span class="token class-name">Quotation</span> <span class="token operator">&lt;</span> ApplicationRecord
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‰€æœ‰å…³äºæŠ¥ä»·å•çš„æ“ä½œæˆ‘éƒ½å°è£…åˆ°QuotationCommandä¸­ï¼Œé€šè¿‡Controllerè°ƒç”¨Commandï¼Œæœ€ç»ˆè°ƒç”¨Model</p>
<pre class="line-numbers language-Mermaid" data-language="Mermaid"><code class="language-Mermaid">graph TD
    A[Controller] --&gt;|è°ƒç”¨| B[Command]
    B --&gt;|è°ƒç”¨| C[Model]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°æˆ‘å°†å¢åˆ æ”¹æŸ¥çš„å¤æ‚ä¸šåŠ¡é€»è¾‘ç»Ÿä¸€æ”¾å…¥åˆ°Commandä¸­ï¼Œå‡å¦‚æˆ‘è¿™æ—¶å€™å†æ¥ä¸€ä¸ªæ–°çš„éœ€æ±‚æ¯”å¦‚æˆ‘è¦å¯¼å‡ºä¸€éƒ¨åˆ†æ•°æ®ï¼Œæˆ‘å°±ç®€å•çš„ç§°ä¸º<code>export</code>å§ï¼Œæ ¹æ®æƒ¯æ€§æˆ‘ä¼šå°†è¿™ä¸ªåŠŸèƒ½ä¹Ÿå®ç°åˆ°QuotationCommandä¸­ã€‚ä¸€åˆ‡è‡ªç„¶è€Œç„¶ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾æˆ‘çš„è¿™ä¸ªç±»æ—©å·²è¿åäº†<strong>å•ä¸€åŠŸèƒ½åŸåˆ™ï¼ˆSingle responsibility principleï¼‰</strong>,ç›´åˆ°æœ‰ä¸€å¤©è¿™ä¸ªå·¨æ— éœ¸çš„Commandä¹Ÿå˜å¾—è‡ƒè‚¿å’Œéš¾ä»¥ç»´æŠ¤ï¼Œéšä¾¿ä¸€ä¸ªä¿®æ”¹éƒ½å¯èƒ½æ˜¯ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„ã€‚æ²¡åŠæ³•æˆ‘ä»¬å†æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†ä¸€ä¸‹å§ã€‚</p>
<pre class="line-numbers language-Mermaid" data-language="Mermaid"><code class="language-Mermaid">graph TD
    A[QuotationController] --&gt;|è°ƒç”¨| B1[::Quotation::CreateCommand]
    A --&gt;|è°ƒç”¨| B2[::Quotation::ModifyCommand]
    A --&gt;|è°ƒç”¨| B3[::Quotation::ListCommand]
    A --&gt;|è°ƒç”¨| B4[::Quotation::ExportCommand]
    
    B1 --&gt;|è°ƒç”¨| C[QuotationModel]
    B2 --&gt;|è°ƒç”¨| C
    B3 --&gt;|è°ƒç”¨| C
    B4 --&gt;|è°ƒç”¨| C<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çœ‹èµ·æ¥å¾ˆæ¼‚äº®ï¼Œæ¯ä¸ªCommandåªè´Ÿè´£è‡ªå·±çš„ä¸šåŠ¡ï¼Œä¿è¯èŒè´£å•ä¸€ï¼Œå¦‚æœå†å‡ºç°æ–°çš„ä¸šåŠ¡åªéœ€è¦æ„å»ºæ–°çš„Commandå³å¯ã€‚</p>
<h2 id="ç‰ˆæœ¬3"><a href="#ç‰ˆæœ¬3" class="headerlink" title="ç‰ˆæœ¬3"></a>ç‰ˆæœ¬3</h2><p>æˆ‘ä»¬ç›®å‰çš„æ–¹æ¡ˆæœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚<code>ExportCommand</code>å¯¼å‡ºåŠŸèƒ½æ˜¯åœ¨åˆ—è¡¨æŸ¥è¯¢çš„åŸºç¡€ä¸Šåšçš„ï¼Œæ¯”å¦‚æˆ‘æœ‰ä¸€ä¸ªåå°ç®¡ç†é¡µé¢ï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ªåˆ—è¡¨æœç´¢é¡µï¼Œé€šè¿‡ä¼ é€’ä¸åŒçš„ç­›é€‰é¡¹ï¼ŒæŸ¥è¯¢å‡ºä¸åŒçš„æ•°æ®ï¼Œä½¿ç”¨<code>ListCommand</code>ã€‚ç°åœ¨æˆ‘å¸Œæœ›èƒ½å°†æŸ¥è¯¢çš„æ•°æ®å¯¼æˆExcelï¼Œä¹Ÿå°±æ˜¯<code>ExportCommand</code>è´Ÿè´£çš„å†…å®¹ï¼Œæ¯«æ— ç–‘é—®æˆ‘æŸ¥è¯¢çš„åŠŸèƒ½å·²ç»æœ‰äº†ï¼Œæˆ‘åªéœ€è¦åœ¨<code>ExportCommand</code>ä¸­ä½¿ç”¨<code>ListCommand</code>å³å¯ï¼Œé‚£è¿™å°±ç‰µæ‰¯åˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>Commandä¹‹å‰æ˜¯å¦å…è®¸ç›¸äº’è°ƒç”¨ï¼Ÿ</p>
</blockquote>
<p>å¦‚æœç›¸äº’å…è®¸è°ƒç”¨ï¼ŒåŠ¿å¿…å¼•å‘è€¦åˆæ€§ï¼Œä¹Ÿå°±æ˜¯<code>ListCommand</code>çš„ä¿®æ”¹åŠ¿å¿…ä¼šå½±å“åˆ°<code>ExportCommand</code></p>
<blockquote>
<p>æŠ½ç¦»Commandæœ¬èº«å¯èƒ½ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
</blockquote>
<p>æˆ‘ä»¬å¼•ç”¨ä¸€äº›DDDä¹¦è¯„è®º</p>
<blockquote>
<p>Now, the more common mistake is to give up too easily on fitting the behavior into an appropriate object, gradually slipping towards procedural programming.*</p>
<p>ç°åœ¨ï¼Œæ›´å¸¸è§çš„é”™è¯¯æ˜¯è¿‡äºè½»æ˜“åœ°æ”¾å¼ƒå°†è¡Œä¸ºé€‚é…åˆ°é€‚å½“çš„å¯¹è±¡ä¸­ï¼Œé€æ¸æ»‘å‘è¿‡ç¨‹ç¼–ç¨‹ã€‚</p>
</blockquote>
<blockquote>
<p><em>Donâ€™t lean too heavily toward modeling a domain concept as a Service. Do so only if the circumstances fit. If we arenâ€™t careful, we might start to treat Services as our modeling â€œsilver bullet.â€ Using Services overzealously will usually result in the negative consequences of creating an Anemic Domain Model, where all the domain logic resides in Services rather than mostly spread across Entities and Value Objects.</em></p>
<p>ä¸è¦è¿‡äºå€¾å‘äºå°†é¢†åŸŸæ¦‚å¿µå»ºæ¨¡ä¸ºä¸€ä¸ª Serviceã€‚ä»…ä»…åœ¨æƒ…å†µé€‚åˆæ—¶æ‰è¿™æ ·åšã€‚å¦‚æœæˆ‘ä»¬ä¸ä»”ç»†åœ°è¯ï¼Œå°±å¯èƒ½ä¼šå¼€å§‹å°† Services è§†ä¸ºå»ºæ¨¡çš„â€œé“¶å¼¹â€ã€‚è¿‡åº¦ä½¿ç”¨ Services é€šå¸¸ä¼šå¯¼è‡´åˆ›å»ºè´«è¡€é¢†åŸŸæ¨¡å‹çš„è´Ÿé¢åæœï¼Œå…¶ä¸­æ‰€æœ‰é¢†åŸŸé€»è¾‘éƒ½é©»ç•™åœ¨ Services ä¸­ï¼Œè€Œä¸æ˜¯ä¸»è¦åˆ†å¸ƒåœ¨å®ä½“å’Œå€¼å¯¹è±¡ä¸­ã€‚</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å¦‚æœä¸å‡æ€ç´¢çš„å°†æ‰€æœ‰çš„è¡Œä¸ºä¸€è‚¡è„‘çš„å¡è¿›Serviceå±‚çº§ä¸­ï¼Œè€Œä¸è€ƒè™‘å†…èšæ€§ï¼ŒæŠ½è±¡æ€§ï¼Œæˆ‘ä»¬ä¼šæ¸æ¸èµ°å‘é¢å‘è¿‡ç¨‹ç¼–ç¨‹ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´æ¨¡å‹<strong>è´«è¡€</strong>ï¼Œå³ä¸ºæºå¸¦æ•°æ®çš„ç©ºå£³ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å†çœ‹çœ‹è¯¥æ€ä¹ˆç»„ç»‡Modelï¼Ÿ</p>
<hr>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>User</code>æ¨¡å‹ï¼Œéšç€ä¸šåŠ¡å‘å±•ï¼Œå®ƒåŒ…å«äº†ç”¨æˆ·è®¤è¯ã€èµ„æ–™ç®¡ç†ã€æƒé™æ£€æŸ¥ã€ç»Ÿè®¡æŠ¥è¡¨ç­‰å¤šç§åŠŸèƒ½ï¼Œå¯¼è‡´ä»£ç é‡è¿‡å¤§ã€‚</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/user.rb</span>
<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> ApplicationRecord
  <span class="token comment"># éªŒè¯ç›¸å…³</span>
  validates <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token symbol">presence</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token symbol">uniqueness</span><span class="token operator">:</span> <span class="token boolean">true</span>
  validates <span class="token symbol">:password</span><span class="token punctuation">,</span> <span class="token symbol">presence</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token symbol">length</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token symbol">minimum</span><span class="token operator">:</span> <span class="token number">8</span> <span class="token punctuation">&#125;</span>
  
  <span class="token comment"># è®¤è¯ç›¸å…³</span>
  has_secure_password
  has_many <span class="token symbol">:sessions</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">generate_auth_token</span></span>
    <span class="token comment"># ç”Ÿæˆè®¤è¯tokençš„é€»è¾‘</span>
  <span class="token keyword">end</span>
  
  <span class="token comment"># èµ„æ–™ç®¡ç†ç›¸å…³</span>
  before_save <span class="token symbol">:format_name</span>
  has_one <span class="token symbol">:profile</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">full_name</span></span>
    <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">first_name</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">last_name</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span>
  <span class="token keyword">end</span>
  
  <span class="token keyword">private</span> <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">format_name</span></span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>first_name <span class="token operator">=</span> first_name<span class="token punctuation">.</span>capitalize
    <span class="token keyword">self</span><span class="token punctuation">.</span>last_name <span class="token operator">=</span> last_name<span class="token punctuation">.</span>capitalize
  <span class="token keyword">end</span>
  
  <span class="token comment"># æƒé™ç›¸å…³</span>
  <span class="token constant">ROLES</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">%w[admin moderator user guest]</span></span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">admin</span></span><span class="token operator">?</span>
    role <span class="token operator">==</span> <span class="token string-literal"><span class="token string">'admin'</span></span>
  <span class="token keyword">end</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">can_edit</span></span><span class="token operator">?</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
    admin<span class="token operator">?</span> <span class="token operator">||</span> resource<span class="token punctuation">.</span>user <span class="token operator">==</span> <span class="token keyword">self</span>
  <span class="token keyword">end</span>
  
  <span class="token comment"># ç»Ÿè®¡ç›¸å…³</span>
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">active_users_count</span></span>
    where<span class="token punctuation">(</span><span class="token symbol">last_active_at</span><span class="token operator">:</span> <span class="token number">1.</span>week<span class="token punctuation">.</span>ago<span class="token operator">..</span><span class="token builtin">Time</span><span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">.</span>count
  <span class="token keyword">end</span>
  
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">activity_score</span></span>
    <span class="token comment"># è®¡ç®—ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ•°</span>
  <span class="token keyword">end</span>

  <span class="token comment"># ... æ›´å¤šæ–¹æ³• ...</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‡Œé¢æ··ä¹±çš„ç»„ç»‡ç€å„ç§æ–¹æ³•ï¼Œå‡å¦‚æˆ‘æƒ³æ‰¾åˆ°æŸä¸ªåŠŸèƒ½ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªä¸ªçš„çœ‹ï¼Œå“ªäº›å¯¹æˆ‘æ˜¯æœ‰ç”¨çš„ã€‚è¿™ä¹Ÿç§°ä¸º<code>Fat Model</code></p>
<p>ä½†å¦‚æœæˆ‘ä»¬èƒ½ç”¨Concernè¿›è¡Œåˆç†åŒ–çš„æ‹†åˆ†èšåˆï¼Œæ•ˆæœå°±ä¼šå®Œå…¨ä¸åŒ</p>
<h3 id="æ‹†åˆ†çš„ç›®å½•ç»“æ„ï¼š"><a href="#æ‹†åˆ†çš„ç›®å½•ç»“æ„ï¼š" class="headerlink" title="æ‹†åˆ†çš„ç›®å½•ç»“æ„ï¼š"></a>æ‹†åˆ†çš„ç›®å½•ç»“æ„ï¼š</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">app/
  models/
    concerns/
      user/
        authenticatable.rb
        profileable.rb
        roleable.rb
        reportable.rb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ‹†åˆ†åConcernæ¨¡å—"><a href="#æ‹†åˆ†åConcernæ¨¡å—" class="headerlink" title="æ‹†åˆ†åConcernæ¨¡å—"></a>æ‹†åˆ†åConcernæ¨¡å—</h3><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/concerns/user/authenticatable.rb</span>
<span class="token keyword">module</span> <span class="token class-name">User</span><span class="token double-colon punctuation">::</span>Authenticatable
  <span class="token keyword">extend</span> ActiveSupport<span class="token double-colon punctuation">::</span>Concern

  included <span class="token keyword">do</span>
    validates <span class="token symbol">:email</span><span class="token punctuation">,</span> <span class="token symbol">presence</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token symbol">uniqueness</span><span class="token operator">:</span> <span class="token boolean">true</span>
    validates <span class="token symbol">:password</span><span class="token punctuation">,</span> <span class="token symbol">presence</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token symbol">length</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token symbol">minimum</span><span class="token operator">:</span> <span class="token number">8</span> <span class="token punctuation">&#125;</span>
    
    has_secure_password
    has_many <span class="token symbol">:sessions</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">generate_auth_token</span></span>
    <span class="token comment"># ç”Ÿæˆè®¤è¯tokençš„é€»è¾‘</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/concerns/user/profileable.rb</span>
<span class="token keyword">module</span> <span class="token class-name">User</span><span class="token double-colon punctuation">::</span>Profileable
  <span class="token keyword">extend</span> ActiveSupport<span class="token double-colon punctuation">::</span>Concern

  included <span class="token keyword">do</span>
    before_save <span class="token symbol">:format_name</span>
    has_one <span class="token symbol">:profile</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">full_name</span></span>
    <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">first_name</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">last_name</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span>
  <span class="token keyword">end</span>

  <span class="token keyword">private</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">format_name</span></span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>first_name <span class="token operator">=</span> first_name<span class="token punctuation">.</span>capitalize
    <span class="token keyword">self</span><span class="token punctuation">.</span>last_name <span class="token operator">=</span> last_name<span class="token punctuation">.</span>capitalize
  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/concerns/user/roleable.rb</span>
<span class="token keyword">module</span> <span class="token class-name">User</span><span class="token double-colon punctuation">::</span>Roleable
  <span class="token keyword">extend</span> ActiveSupport<span class="token double-colon punctuation">::</span>Concern

  included <span class="token keyword">do</span>
    <span class="token constant">ROLES</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">%w[admin moderator user guest]</span></span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">admin</span></span><span class="token operator">?</span>
    role <span class="token operator">==</span> <span class="token string-literal"><span class="token string">'admin'</span></span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">can_edit</span></span><span class="token operator">?</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
    admin<span class="token operator">?</span> <span class="token operator">||</span> resource<span class="token punctuation">.</span>user <span class="token operator">==</span> <span class="token keyword">self</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/concerns/user/reportable.rb</span>
<span class="token keyword">module</span> <span class="token class-name">User</span><span class="token double-colon punctuation">::</span>Reportable
  <span class="token keyword">extend</span> ActiveSupport<span class="token double-colon punctuation">::</span>Concern

  class_methods <span class="token keyword">do</span>
    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">active_users_count</span></span>
      where<span class="token punctuation">(</span><span class="token symbol">last_active_at</span><span class="token operator">:</span> <span class="token number">1.</span>week<span class="token punctuation">.</span>ago<span class="token operator">..</span><span class="token builtin">Time</span><span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">.</span>count
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">activity_score</span></span>
    <span class="token comment"># è®¡ç®—ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ•°</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ‹†åˆ†åçš„Useræ¨¡å‹"><a href="#æ‹†åˆ†åçš„Useræ¨¡å‹" class="headerlink" title="æ‹†åˆ†åçš„Useræ¨¡å‹"></a>æ‹†åˆ†åçš„Useræ¨¡å‹</h3><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># app/models/user.rb</span>
<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> ApplicationRecord
  <span class="token keyword">include</span> User<span class="token double-colon punctuation">::</span>Authenticatable
  <span class="token keyword">include</span> User<span class="token double-colon punctuation">::</span>Profileable
  <span class="token keyword">include</span> User<span class="token double-colon punctuation">::</span>Roleable
  <span class="token keyword">include</span> User<span class="token double-colon punctuation">::</span>Reportable
  
  <span class="token comment"># è¿™é‡Œåªä¿ç•™æ¨¡å‹ç‰¹æœ‰çš„æˆ–æ— æ³•åˆ†ç±»çš„æ–¹æ³•</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™æ ·æ‹†åˆ†åï¼Œå¯èƒ½éƒ½ä¸ç”¨æ„å»ºç‰¹å®šçš„Commandï¼Œæ¨¡å‹æœ¬èº«ç»´æŠ¤æ‹†åˆ†è‰¯å¥½çš„åŠŸèƒ½ï¼Œæ¥è®©Controllerç›´æ¥è¿›è¡Œè°ƒç”¨</p>
<p>ä½†æ˜¯è¿™ä¹Ÿè¦æ±‚å›¢é˜Ÿå†…çš„æˆå‘˜éµå®ˆç»Ÿä¸€çš„è§„èŒƒå’Œè¦æ±‚ï¼Œå¹¶ä¸”å…·æœ‰è‰¯å¥½çš„æŠ½è±¡åŒ–æ€æƒ³ï¼Œè¿™ä¸€ç‚¹å¾ˆéš¾ï¼Œæœ€éš¾çš„å¯èƒ½æ˜¯å¦‚ä½•ç»™ä½ çš„æ¨¡å—å‘½åğŸ¤£ï¼Œå› ä¸ºå®ƒç›´æ¥åæ˜ äº†è¯¥æ¨¡å—å„¿çš„å†…æ¶µã€‚</p>
<hr>
<p>ç®€ç•¥æ€»ç»“å‡ ç‚¹ï¼š</p>
<ol>
<li>é¼“åŠ±æ„å»º<code>rich domain model</code>ï¼Œä¸è¿‡ä¸ºäº†é¿å…<code>Fat</code><ol>
<li>ä½¿ç”¨Concernæ¥ç»„ç»‡Modelçš„ä»£ç </li>
<li>å°†å¤æ‚åŠŸèƒ½å§”æ‰˜åˆ°é¢å¤–çš„å¯¹è±¡ç³»ç»Ÿï¼ˆPOROï¼‰</li>
<li>ActiveRecordå’ŒPoroè§†ä¸ºä¸€æ•´å¥—é¢†åŸŸæ¨¡å‹ï¼Œè€Œè‡³äºæ˜¯å¦éœ€è¦æŒä¹…åŒ–ï¼Œä¸šåŠ¡é€»è¾‘æ¶ˆè´¹è€…å¹¶ä¸åœ¨æ„</li>
</ol>
</li>
<li>å¯¹äºå¤æ‚çš„è¡Œä¸ºï¼Œå¯æ„å»ºService/Commandï¼Œä½†æ˜¯éœ€è¦è°¨æ…å’Œè‰¯å¥½çš„è®¾è®¡</li>
</ol>
<p>æ¯”è¾ƒæœ‰è¶£çš„æ˜¯ï¼š<code>37signal</code>å¾ˆæ¿€è¿›ï¼Œè§‰å¾—Serviceå±‚éƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://www.chengling.cloud">åºšè¾°</a></span></div><!--.post-copyright__type--><!--  span.post-copyright-meta= _p('post.copyright.link') + ": "--><!--  span.post-copyright-info--><!--    a(href=url_for(url))= theme.post_copyright.decode ? decodeURI(url) : url--><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://www.chengling.cloud" target="_blank">ç²è¾°ä¹¦æ–‹</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/rails/">rails</a></div><div class="post_share"><div class="social-share" data-image="/img/default_top_img.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/post/Ruby/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html"><img class="next-cover" src="/img/default_top_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info"></div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/myHead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">åºšè¾°</div><div class="author-info__description">è¦ä¹ˆè¯»ä¹¦ï¼Œè¦ä¹ˆæ—…è¡Œï¼Œèº«ä½“å’Œå¿ƒçµæ€»æœ‰ä¸€ä¸ªè¦åœ¨è·¯ä¸Š.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">73</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/GengCen-Qin"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Rails%E5%B1%82%E7%BA%A7%E8%AE%BE%E8%AE%A1%E6%BC%94%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">Railså±‚çº§è®¾è®¡æ¼”åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC1"><span class="toc-number">1.1.</span> <span class="toc-text">ç‰ˆæœ¬1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC2"><span class="toc-number">1.2.</span> <span class="toc-text">ç‰ˆæœ¬2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC3"><span class="toc-number">1.3.</span> <span class="toc-text">ç‰ˆæœ¬3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-number">1.3.1.</span> <span class="toc-text">æ‹†åˆ†çš„ç›®å½•ç»“æ„ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E5%90%8EConcern%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.</span> <span class="toc-text">æ‹†åˆ†åConcernæ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E5%90%8E%E7%9A%84User%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">æ‹†åˆ†åçš„Useræ¨¡å‹</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/Ruby/Rails%E6%9E%B6%E6%9E%84%E5%B1%82%E7%BA%A7%E8%AE%BE%E8%AE%A1.html" title="Railså±‚çº§è®¾è®¡æ¼”åŒ–"><img src="/img/default_top_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Railså±‚çº§è®¾è®¡æ¼”åŒ–"/></a><div class="content"><a class="title" href="/post/Ruby/Rails%E6%9E%B6%E6%9E%84%E5%B1%82%E7%BA%A7%E8%AE%BE%E8%AE%A1.html" title="Railså±‚çº§è®¾è®¡æ¼”åŒ–">Railså±‚çº§è®¾è®¡æ¼”åŒ–</a><time datetime="2025-07-09T02:30:12.000Z" title="å‘è¡¨äº 2025-07-09 10:30:12">2025-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Ruby/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html" title="æ— é¢˜"><img src="/img/default_top_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ— é¢˜"/></a><div class="content"><a class="title" href="/post/Ruby/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html" title="æ— é¢˜">æ— é¢˜</a><time datetime="2025-05-23T13:28:31.651Z" title="å‘è¡¨äº 2025-05-23 21:28:31">2025-05-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/%E5%B7%A5%E5%85%B7/%E8%AD%A6%E6%83%95AI.html" title="è­¦æƒ•AI"><img src="/img/default_top_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="è­¦æƒ•AI"/></a><div class="content"><a class="title" href="/post/%E5%B7%A5%E5%85%B7/%E8%AD%A6%E6%83%95AI.html" title="è­¦æƒ•AI">è­¦æƒ•AI</a><time datetime="2025-04-06T10:00:00.000Z" title="å‘è¡¨äº 2025-04-06 18:00:00">2025-04-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/Ruby/Ruby%E5%85%83%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98.html" title="Rubyå…ƒç¼–ç¨‹å®æˆ˜"><img src="/img/default_top_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Rubyå…ƒç¼–ç¨‹å®æˆ˜"/></a><div class="content"><a class="title" href="/post/Ruby/Ruby%E5%85%83%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98.html" title="Rubyå…ƒç¼–ç¨‹å®æˆ˜">Rubyå…ƒç¼–ç¨‹å®æˆ˜</a><time datetime="2025-02-09T05:03:04.000Z" title="å‘è¡¨äº 2025-02-09 13:03:04">2025-02-09</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/post/%E6%B5%8B%E8%AF%95/RSpec%20%E6%B5%8B%E8%AF%95%E7%A4%BA%E4%BE%8B%E4%B8%8E%E6%8A%80%E5%B7%A7%E8%AF%B4%E6%98%8E.html" title="RSpec æµ‹è¯•ç¤ºä¾‹ä¸æŠ€å·§è¯´æ˜">RSpec æµ‹è¯•ç¤ºä¾‹ä¸æŠ€å·§è¯´æ˜</a><time datetime="2025-01-12T09:24:42.000Z" title="å‘è¡¨äº 2025-01-12 17:24:42">2025-01-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By åºšè¾°</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a><br>
<a href="https://beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">é™•ICPå¤‡2022014054å·</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="498210" data-server="netease" data-type="song" data-fixed="true" data-autoplay="true" data-lrcType="-1"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>